{
  "title": "GoodDayTaxi Monitoring (Local)",
  "uid": "goodday-local",
  "timezone": "browser",
  "refresh": "5s",
  "schemaVersion": 36,
  "version": 1,
  "panels": [
    {
      "type": "stat",
      "title": "서비스 응답 성공률 (%)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(http_server_requests_seconds_count{application!=\"\"}[1m])) - sum(rate(http_server_requests_seconds_count{status!~\"2..\",application!=\"\"}[1m])) \n / sum(rate(http_server_requests_seconds_count{application!=\"\"}[1m])) * 100",
          "legendFormat": "Success Rate"
        }
      ],
      "gridPos": { "x": 0, "y": 0, "w": 4, "h": 4 }
    },
    {
      "type": "stat",
      "title": "오류율 (%)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(http_server_requests_seconds_count{status!~\"2..\",application!=\"\"}[1m]))  / sum(rate(http_server_requests_seconds_count{application!=\"\"}[1m])) * 100",
          "legendFormat": "Error Rate"
        }
      ],
      "gridPos": { "x": 4, "y": 0, "w": 4, "h": 4 }
    },
    {
      "type": "stat",
      "title": "초당 요청 수 (RPS)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(http_server_requests_seconds_count{application!=\"\"}[1m]))",
          "legendFormat": "RPS"
        }
      ],
      "gridPos": { "x": 8, "y": 0, "w": 4, "h": 4 }
    },
    {
      "type": "stat",
      "title": "평균 응답 시간 (ms)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(http_server_requests_seconds_sum{application!=\"\"}[1m])) / sum(rate(http_server_requests_seconds_count{application!=\"\"}[1m])) * 1000",
          "legendFormat": "Avg Latency"
        }
      ],
      "gridPos": { "x": 12, "y": 0, "w": 4, "h": 4 }
    },
    {
      "type": "timeseries",
      "title": "HTTP 요청 수 (상세)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "rate(http_server_requests_seconds_count{application!=\"\"}[1m])",
          "legendFormat": "{{method}} {{uri}} {{status}}"
        }
      ],
      "gridPos": { "x": 0, "y": 4, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "HTTP 응답 시간 (Latency)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "(rate(http_server_requests_seconds_sum{application!=\"\"}[1m]) / rate(http_server_requests_seconds_count{application!=\"\"}[1m])) * 1000",
          "legendFormat": "{{method}} {{uri}}"
        }
      ],
      "gridPos": { "x": 12, "y": 4, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "JVM Heap 사용량",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "jvm_memory_used_bytes{area=\"heap\",application!=\"\"}",
          "legendFormat": "{{application}} heap"
        }
      ],
      "gridPos": { "x": 0, "y": 11, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "JVM Non-Heap 사용량",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "jvm_memory_used_bytes{area=\"nonheap\",application!=\"\"}",
          "legendFormat": "{{application}} nonheap"
        }
      ],
      "gridPos": { "x": 12, "y": 11, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "GC 시간 / GC 횟수",
      "datasource": "Prometheus",
      "targets": [
        { "expr": "rate(jvm_gc_pause_seconds_sum[1m])", "legendFormat": "GC Pause" },
        { "expr": "rate(jvm_gc_pause_seconds_count[1m])", "legendFormat": "GC Count" }
      ],
      "gridPos": { "x": 0, "y": 18, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "CPU 사용량 (%)",
      "datasource": "Prometheus",
      "targets": [
        { "expr": "system_cpu_usage", "legendFormat": "System" },
        { "expr": "process_cpu_usage", "legendFormat": "Process" }
      ],
      "gridPos": { "x": 12, "y": 18, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "스레드 수 (JVM Threads)",
      "datasource": "Prometheus",
      "targets": [
        { "expr": "jvm_threads_live_threads", "legendFormat": "live" },
        { "expr": "jvm_threads_daemon_threads", "legendFormat": "daemon" },
        { "expr": "jvm_threads_peak_threads", "legendFormat": "peak" }
      ],
      "gridPos": { "x": 0, "y": 25, "w": 12, "h": 7 }
    },
    {
      "type": "timeseries",
      "title": "HikariCP 커넥션 풀",
      "datasource": "Prometheus",
      "targets": [
        { "expr": "hikaricp_connections_active", "legendFormat": "Active" },
        { "expr": "hikaricp_connections_idle", "legendFormat": "Idle" },
        { "expr": "hikaricp_connections_pending", "legendFormat": "Pending" }
      ],
      "gridPos": { "x": 12, "y": 25, "w": 12, "h": 7 }
    }
  ]
}
